/*!
 * ion-autocomplete 0.1.2
 * Copyright 2015 Danny Povolotski 
 * Copyright modifications 2015 Guy Brand 
 * https://github.com/guylabs/ion-autocomplete
 */
!function(){"use strict";angular.module("ion-autocomplete",[]).directive("ionAutocomplete",["$ionicTemplateLoader","$ionicBackdrop","$rootScope","$document","$q","$parse",function(a,b,c,d,e,f){return{require:"?ngModel",restrict:"E",template:'<input type="text" readonly="readonly" class="ion-autocomplete" autocomplete="off">',replace:!0,scope:{itemsMethod:"&",itemsMethodValueKey:"@",itemValueKey:"@",itemViewValueKey:"@"},link:function(c,g,h,i){if(i){var j="";h.placeholder&&(j=h.placeholder,g.attr("placeholder",h.placeholder));var k="Cancel";h.cancelLabel&&(k=h.cancelLabel),c.items=[],c.searchQuery="",c.getItemValue=function(a,b){var c;return c=b&&angular.isObject(a)?f(b)(a):a};var l=['<div class="ion-autocomplete-container">','<div class="bar bar-header item-input-inset">','<label class="item-input-wrapper">','<i class="icon ion-ios7-search placeholder-icon"></i>','<input type="search" class="ion-autocomplete-search" ng-model="searchQuery" placeholder="'+j+'"/>',"</label>",'<button class="ion-autocomplete-cancel button button-clear">',k,"</button>","</div>",'<ion-content class="has-header has-header">',"<ion-list>",'<ion-item ng-repeat="item in items" type="item-text-wrap" ng-click="selectItem(item)">',"{{getItemValue(item, itemViewValueKey)}}","</ion-item>","</ion-list>","</ion-content>","</div>"].join("");a.compile({template:l,scope:c,appendTo:d[0].body}).then(function(a){var c=angular.element(a.element.find("input"));a.scope.selectItem=function(c){a.scope.items=[],a.scope.searchQuery="",i.$setViewValue(c),i.$render(),a.element.css("display","none"),b.release()},a.scope.$watch("searchQuery",function(b){if(""==b&&(a.scope.items=[]),b&&angular.isFunction(a.scope.itemsMethod)){var c=e.when(a.scope.itemsMethod({query:b}));c.then(function(b){a.scope.items=a.scope.getItemValue(b,a.scope.itemsMethodValueKey)},function(a){return e.reject(a)})}});var d=function(d){d.preventDefault(),d.stopPropagation(),b.retain(),a.element.css("display","block"),c[0].focus(),setTimeout(function(){c[0].focus()},0)};g.bind("click",d),g.bind("touchend",d),a.element.find("button").bind("click",function(){a.scope.searchQuery="",b.release(),a.element.css("display","none")})}),i.$render=function(){var a=c.getItemValue(i.$viewValue,c.itemViewValueKey);g.val(a)},i.$formatters.push(function(a){return c.getItemValue(a,c.itemViewValueKey)}),i.$parsers.push(function(a){return c.getItemValue(a,c.itemValueKey)})}}}}])}();